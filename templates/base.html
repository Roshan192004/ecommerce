{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Avnik Biotech{% endblock %}</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

  <!-- Global CSS -->
  <link href="{% static 'css/style.css' %}" rel="stylesheet">

  <!-- Page-specific CSS (IMPORTANT) -->
  {% block extra_css %}{% endblock %}
</head>
<body>

<!-- ================= TOP HEADER ================= -->
<div class="top-header">
  <div class="container d-flex align-items-center justify-content-between">
    
    <!-- LOGO -->
    <div class="logo d-flex align-items-center">
      <img src="{% static 'images/logo.jpg' %}" alt="Avnik Biotech" class="logo-img">
      <a href="{% url 'home' %}" class="navbar-brand text-white text-decoration-none ms-2">
        Avnik Biotech
      </a>
    </div>

    <!-- LOCATION -->
    <div class="location" data-bs-toggle="modal" data-bs-target="#locationModal" style="cursor:pointer;">
      <i class="fa fa-map-marker-alt me-1"></i>
      {% if request.session.delivery_location %}
        Deliver to {{ request.session.delivery_location.city }},
        {{ request.session.delivery_location.pincode }}
      {% else %}
        Deliver to your location
      {% endif %}
    </div>

    <!-- SEARCH -->
    <div class="search-bar">
      <input type="text" placeholder="Search for medicines, lab tests, beauty & wellness">
    </div>

    <!-- PROFILE -->
    <div class="header-actions position-relative">

      {% if user.is_authenticated %}
      <div class="profile-wrapper" onclick="toggleProfileMenu()">
        <div class="profile-btn d-flex align-items-center gap-2">
          <i class="fa fa-user-circle fs-4"></i>
          <span class="profile-username">
            {{ user.first_name|default:user.username }}
          </span>
        </div>

        <div class="profile-menu" id="profileMenu">
          <a href="{% url 'my_orders' %}">
            <i class="fa fa-box"></i> My Orders
          </a>
          <a href="#">
            <i class="fa fa-map-marker-alt"></i> My Addresses
          </a>
          <a href="#">
            <i class="fa fa-book-medical"></i> Health Records
          </a>
          <a href="#">
            <i class="fa fa-bookmark"></i> Saved for Later
          </a>
          <hr>
          <a href="{% url 'logout' %}" class="logout">
            <i class="fa fa-power-off"></i> Sign Out
          </a>
        </div>
      </div>
      {% else %}
        <a href="{% url 'login' %}" class="header-link me-3">Sign In</a>
        <a href="{% url 'register' %}" class="header-link">Register</a>
      {% endif %}

    </div>
  </div>
</div>

<!-- ================= CATEGORY BAR ================= -->
<div class="category-bar">
  <div class="container d-flex gap-4 align-items-center">

    <div class="medicine-menu">
      <button class="cat-link medicine-btn" onclick="toggleMedicineDropdown()">
        <i class="fa-solid fa-pills me-1"></i> Medicine
      </button>

      <div class="medicine-dropdown" id="medicineDropdown">
        <a href="{% url 'all_medicines' %}">All Medicines</a>
        <a href="#">Medicines by Health Issues</a>
        <a href="#">Medicines for Body Parts</a>
        <a href="#">Medicines by Generic Name</a>
      </div>
    </div>

    <a href="#" class="cat-link">Lab Tests</a>
    <a href="#" class="cat-link">Beauty</a>
    <a href="#" class="cat-link">Wellness</a>
    <a href="#" class="cat-link">Health Corner</a>
    <a href="#" class="cat-link">Offers</a>

    <a href="{% url 'cart' %}" class="cat-link ms-auto">
      <i class="fa fa-shopping-cart"></i> Cart
    </a>
  </div>
</div>

<!-- ================= PAGE CONTENT ================= -->
{% block content %}
{% endblock %}

<!-- ================= FOOTER ================= -->
<!-- ================= FOOTER ================= -->
<footer class="site-footer">
  <div class="container footer-top">
    <div class="row">

      <!-- COMPANY -->
      <div class="col-md-3 col-sm-6">
        <h5>COMPANY</h5>
        <ul>
          <li><a href="#">About Avnik Biotech</a></li>
          <li><a href="#">Career</a></li>
          <li><a href="#">Sitemap</a></li>
        </ul>
      </div>

      <!-- OUR POLICIES -->
      <div class="col-md-3 col-sm-6">
        <h5>OUR POLICIES</h5>
        <ul>
          <li><a href="#">Terms & Conditions</a></li>
          <li><a href="#">Privacy Policy</a></li>
          <li><a href="#">Fees & Payments Policy</a></li>
          <li><a href="#">Shipping & Delivery Policy</a></li>
          <li><a href="#">Return, Refund & Cancellation Policy</a></li>
        </ul>
      </div>

      <!-- SHOPPING -->
      <div class="col-md-3 col-sm-6">
        <h5>SHOPPING</h5>
        <ul>
          <li><a href="#">Medicines A to Z</a></li>
          <li><a href="#">Shop by Categories</a></li>
          <li><a href="#">Offers / Coupons</a></li>
          <li><a href="#">FAQs</a></li>
          <li><a href="#">Contact Us</a></li>
        </ul>
      </div>

      <!-- SOCIAL -->
      <div class="col-md-3 col-sm-6">
        <h5>SOCIAL</h5>
        <ul>
          <li><a href="#">Facebook</a></li>
          <li><a href="#">Twitter</a></li>
          <li><a href="#">LinkedIn</a></li>
          <li><a href="#">YouTube</a></li>
          <li><a href="#">Instagram</a></li>
        </ul>
      </div>

    </div>
  </div>

  <div class="footer-bottom text-center">
    Â© 2026 Avnik Biotech. All rights reserved.
  </div>
</footer>

<!-- ================= LOCATION MODAL ================= -->
<div class="modal fade" id="locationModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-4">
      <h5>Where do you want the delivery?</h5>

      {% if request.session.delivery_error %}
        <p class="text-danger small">{{ request.session.delivery_error }}</p>
      {% endif %}

      <form method="post" action="{% url 'set_location' %}">
        {% csrf_token %}
        <input type="text" name="pincode" class="form-control" placeholder="Enter PIN Code" required>
        <button class="btn btn-success mt-3 w-100">Check</button>
      </form>
    </div>
  </div>
</div>

<!-- ================= SCRIPTS ================= -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
function toggleMedicineDropdown() {
  const dropdown = document.getElementById("medicineDropdown");
  dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
}

function toggleProfileMenu() {
  const menu = document.getElementById("profileMenu");
  menu.style.display = menu.style.display === "block" ? "none" : "block";
}

window.addEventListener("click", function(e) {
  const profile = document.querySelector(".profile-wrapper");
  const medicine = document.querySelector(".medicine-menu");

  if (profile && !profile.contains(e.target)) {
    document.getElementById("profileMenu").style.display = "none";
  }
  if (medicine && !medicine.contains(e.target)) {
    document.getElementById("medicineDropdown").style.display = "none";
  }
});
</script>

</body>
</html>
