{% extends 'base.html' %}

{% block content %}

<h2 class="mb-4">Checkout</h2>

<!-- ❌ Delivery error (only when location not serviceable) -->
{% if messages %}
  {% for message in messages %}
    <div class="alert alert-danger">
      {{ message }}
    </div>
  {% endfor %}
{% endif %}

<table class="table table-bordered">
  <thead class="table-dark">
    <tr>
      <th>Medicine</th>
      <th style="width: 100px;">Qty</th>
      <th style="width: 150px;">Price</th>
    </tr>
  </thead>

  <tbody>
    {% for item in items %}
      <tr>
        <td>{{ item.medicine.name }}</td>
        <td>{{ item.quantity }}</td>
        <td>₹{{ item.medicine.price }}</td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="3" class="text-center text-muted">
          No items in cart
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<div class="d-flex justify-content-between align-items-center mt-4">
  <h4>Total Amount: <strong>₹{{ total }}</strong></h4>

  <!-- ✅ PLACE ORDER MUST BE POST -->
  <form method="post" action="{% url 'place_order' %}">
    {% csrf_token %}
    <button type="submit" class="btn btn-success btn-lg">
      Place Order
    </button>
  </form>
</div>

{% endblock %}